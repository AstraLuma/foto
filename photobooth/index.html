<!doctype html>
<html>
  <head>
    <title>Foto</title>
    <script src="components/platform/platform.js"></script>
    <link rel="import" href="components/webcam.html">
    <script src="components/jquery/dist/jquery.min.js"></script>
    <style>
    #webcam {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: -10;
    }
    #snaps > img {
        max-width: 10em;
        display: block;
    }
    #countdown {
        position: absolute;
        top: 0;
        right: 0;
        font-size: 10em;
    }
    </style>
  </head>
  <body>
    <foto-webcam id="webcam" auto></foto-webcam>
    <div id="countdown"></div>
    <button id="snap">Take Picture</button>
    <div id="snaps"></div>
    <img id="preview">
    <script async>
function takePhoto() {
    var currentCount = 3;
    $('#countdown').text(currentCount);
    var intid = window.setInterval(function() {
        currentCount--;
        if (currentCount > 0) {
            $('#countdown').text(currentCount);
        } else {
            $('#countdown').text("");
            window.clearInterval(intid);
            $('#webcam')[0].take().then(function(photo) {
                $('#snaps').append(
                    $('<img>').attr('src', photo)
                );
            });
        }
    }, 1000);
}

$(function() {
    $('#snap').click(takePhoto);
    $('#webcam').click(takePhoto);
});
    </script>
  </body>
</html>